var e=Object.defineProperty,s=(s,n,o)=>(((s,n,o)=>{n in s?e(s,n,{enumerable:!0,configurable:!0,writable:!0,value:o}):s[n]=o})(s,"symbol"!=typeof n?n+"":n,o),o);import{r as n,_ as o,c as l,o as t,a,w as u,i as r,b as c,d as i,t as d,e as v,f as p,F as f,g as _,h as g,n as h,j as k,k as m,l as y,m as b,p as L,q as w,s as C,u as I,v as x,I as j,x as O,y as T}from"./index-B-4q1X1W.js";const q=(e,s)=>{const n=e[s];return n?"function"==typeof n?n():Promise.resolve(n):new Promise(((e,n)=>{("function"==typeof queueMicrotask?queueMicrotask:setTimeout)(n.bind(null,new Error("Unknown variable dynamic import: "+s)))}))};const A=new class{constructor(){s(this,"lessons",n([]))}async loadLessons(e){try{const s=await Promise.all([q(Object.assign({"../data/book2/lesson1.json":()=>o((()=>import("./data-book2-lesson1.CFY-1SCX.js")),[]),"../data/book3/lesson1.json":()=>o((()=>import("./data-book3-lesson1.C6FZkPCR.js")),[])}),`../data/book${e}/lesson1.json`),q(Object.assign({"../data/book2/lesson2.json":()=>o((()=>import("./data-book2-lesson2.Bk9bZfOB.js")),[]),"../data/book3/lesson2.json":()=>o((()=>import("./data-book3-lesson2.IBj7tfJz.js")),[])}),`../data/book${e}/lesson2.json`)]);this.lessons.value=s.map((e=>e.default))}catch(s){console.error("Error loading lessons:",s),this.lessons.value=[]}}getLessons(){return this.lessons}getLesson(e){return this.lessons.value.find((s=>s.id===e))}},M=(e,s)=>{const n=e.__vccOpts||e;for(const[o,l]of s)n[o]=l;return n};const P=M({components:{LessonSelector:M({emits:["lesson-changed"],setup(e,{emit:s}){const o=n(0),a=n(0),u=n(""),r=l((()=>A.getLessons().value)),c=l((()=>r.value.map((e=>e.title))));return t((async()=>{try{await A.loadLessons(2),s("lesson-changed",r.value[0])}catch(e){u.value="加载课程失败，请重试"}})),{books:["NCE2","NCE3"],lessonTitles:c,selectedBookIndex:o,selectedLessonIndex:a,error:u,onBookChange:async e=>{try{o.value=e.detail.value,a.value=0,await A.loadLessons(o.value+2),s("lesson-changed",r.value[0])}catch(n){u.value="加载课程失败，请重试"}},onLessonChange:e=>{a.value=e.detail.value,s("lesson-changed",r.value[a.value])}}}},[["render",function(e,s,n,o,l,t){const g=r,h=_;return c(),a(g,{class:"lesson-selector"},{default:u((()=>[o.error?(c(),a(g,{key:0,class:"error"},{default:u((()=>[i(d(o.error),1)])),_:1})):(c(),v(f,{key:1},[p(h,{onChange:o.onBookChange,value:o.selectedBookIndex,range:o.books,class:"picker"},{default:u((()=>[p(g,{class:"picker-text"},{default:u((()=>[i(d(o.books[o.selectedBookIndex]),1)])),_:1})])),_:1},8,["onChange","value","range"]),p(h,{onChange:o.onLessonChange,value:o.selectedLessonIndex,range:o.lessonTitles,class:"picker"},{default:u((()=>[p(g,{class:"picker-text"},{default:u((()=>[i(d(o.lessonTitles[o.selectedLessonIndex]),1)])),_:1})])),_:1},8,["onChange","value","range"])],64))])),_:1})}],["__scopeId","data-v-348b9f48"]]),DictationMode:M({components:{ProgressBar:M(g({props:{current:{type:Number,required:!0},total:{type:Number,required:!0}},setup:e=>({percentage:l((()=>e.current/e.total*100))})}),[["render",function(e,s,n,o,l,t){const v=r,f=k;return c(),a(v,{class:"progress-container"},{default:u((()=>[p(v,{class:"progress-bar"},{default:u((()=>[p(v,{class:"progress-bar-inner",style:h({width:`${e.percentage}%`})},null,8,["style"])])),_:1}),p(f,{class:"progress-text"},{default:u((()=>[i(d(e.current)+" / "+d(e.total),1)])),_:1})])),_:1})}],["__scopeId","data-v-ad6269a7"]])},props:{lesson:{type:Object,required:!0}},setup(e){const s=n(0),o=n([]),a=n(!1),u=n(!1),r=n([]),c=n([]),i=n(0),d=l((()=>e.lesson.content[s.value])),v=l((()=>d.value?d.value.english.split(/(\s+|[.,!?;:'"()[\]{}])/).filter((e=>""!==e.trim())):[])),p=l((()=>v.value.filter((e=>!f(e)&&!_(e))))),f=e=>/^[.,!?;:'"()[\]{}]$/.test(e),_=e=>/^\s+$/.test(e);m(v,(()=>{o.value=v.value.map((e=>f(e)||_(e)?e:"")),r.value=new Array(p.value.length).fill(null),c.value=[]}),{immediate:!0});const g=e=>{i.value=e};t((()=>{g(0)}));const h=()=>{if(!d.value)return;o.value.filter(((e,s)=>!f(v.value[s])&&!_(v.value[s]))).join(" ").toLowerCase()===p.value.join(" ").toLowerCase()?(u.value=!0,s.value<e.lesson.content.length-1&&(s.value++,o.value=v.value.map((e=>f(e)||_(e)?e:"")),g(0))):u.value=!1},k=l((()=>e.lesson.content.length)),y=l((()=>0===s.value)),b=l((()=>s.value===k.value-1)),L=()=>{o.value=new Array(p.value.length).fill(""),c.value=[],a.value=!1,g(0)};return{currentIndex:s,currentSentence:d,allWords:v,currentWords:p,userInputs:o,showResult:a,isCorrect:u,checkAnswer:h,onInput:e=>{c.value=c.value.filter((s=>s!==e))},onSpace:e=>{e<p.value.length-1?o.value[e].toLowerCase()===p.value[e].toLowerCase()?g(e+1):c.value.push(e):e===p.value.length-1&&(o.value[e].toLowerCase()===p.value[e].toLowerCase()?h():c.value.push(e))},onBackspace:e=>{e>0&&""===o.value[e]&&g(e-1)},inputRefs:r,shakeIndexes:c,isWordIncorrect:e=>{const s=v.value.findIndex(((s,n)=>n>=e&&!f(s)&&!_(s)));return Boolean(o.value[s]&&o.value[s].toLowerCase()!==p.value[e].toLowerCase())},focusIndex:i,onBlur:e=>{i.value===e&&(i.value=-1)},onFocus:e=>{i.value=e},totalSentences:k,isFirstSentence:y,isLastSentence:b,goToPrevious:()=>{y.value||(s.value--,L())},goToNext:()=>{b.value||(s.value++,L())},isPunctuation:f,isSpace:_}}},[["render",function(e,s,n,o,l,t){const _=y("ProgressBar"),g=r,m=k,O=j,T=w;return o.currentSentence?(c(),a(g,{key:0,class:"dictation-mode"},{default:u((()=>[p(g,{class:"progress-container"},{default:u((()=>[p(_,{current:o.currentIndex+1,total:o.totalSentences},null,8,["current","total"])])),_:1}),p(m,{class:"chinese-sentence"},{default:u((()=>[i(d(o.currentSentence.chinese),1)])),_:1}),p(g,{class:"input-container"},{default:u((()=>[(c(!0),v(f,null,L(o.allWords,((e,s)=>(c(),v(f,{key:s},[o.isPunctuation(e)?(c(),a(g,{key:0,class:"punctuation"},{default:u((()=>[i(d(e),1)])),_:2},1024)):o.isSpace(e)?(c(),a(g,{key:1,class:"space"},{default:u((()=>[i(d(e),1)])),_:2},1024)):(c(),a(g,{key:2,class:C(["word-input",{shake:o.shakeIndexes.includes(s),"word-error":o.isWordIncorrect(o.currentWords.indexOf(e)),focused:o.focusIndex===o.currentWords.indexOf(e)}])},{default:u((()=>[p(O,{style:h({width:10*e.length+40+"px"}),modelValue:o.userInputs[s],"onUpdate:modelValue":e=>o.userInputs[s]=e,onInput:s=>o.onInput(o.currentWords.indexOf(e)),onKeydown:[I(x((s=>o.onSpace(o.currentWords.indexOf(e))),["prevent"]),["space"]),I((s=>o.onBackspace(o.currentWords.indexOf(e))),["backspace"])],onKeyup:I(o.checkAnswer,["enter"]),focus:o.focusIndex===o.currentWords.indexOf(e),onBlur:s=>o.onBlur(o.currentWords.indexOf(e)),onFocus:s=>o.onFocus(o.currentWords.indexOf(e))},null,8,["style","modelValue","onUpdate:modelValue","onInput","onKeydown","onKeyup","focus","onBlur","onFocus"])])),_:2},1032,["class"]))],64)))),128))])),_:1}),p(g,{class:"bottom-navigation"},{default:u((()=>[p(T,{class:"nav-icon",onClick:o.goToPrevious,disabled:o.isFirstSentence},{default:u((()=>[i(" ◀ ")])),_:1},8,["onClick","disabled"]),p(T,{class:"nav-icon",onClick:o.goToNext,disabled:o.isLastSentence},{default:u((()=>[i(" ▶ ")])),_:1},8,["onClick","disabled"])])),_:1})])),_:1})):b("",!0)}],["__scopeId","data-v-c9c2a54b"]]),ReadingMode:M({props:["lesson"],setup:e=>({fullEnglishText:l((()=>e.lesson.content.map((e=>e.english)).join(" "))),fullChineseText:l((()=>e.lesson.content.map((e=>e.chinese)).join(" ")))})},[["render",function(e,s,n,o,l,t){const _=k,g=r;return c(),a(g,{class:"reading-mode"},{default:u((()=>[p(g,{class:"english-section"},{default:u((()=>[p(_,{class:"section-title"},{default:u((()=>[i("英文")])),_:1}),p(_,{class:"english-content"},{default:u((()=>[i(d(o.fullEnglishText),1)])),_:1})])),_:1}),p(g,{class:"chinese-section"},{default:u((()=>[p(_,{class:"section-title"},{default:u((()=>[i("中文")])),_:1}),p(_,{class:"chinese-content"},{default:u((()=>[i(d(o.fullChineseText),1)])),_:1})])),_:1}),p(g,{class:"key-points-section"},{default:u((()=>[p(_,{class:"section-title"},{default:u((()=>[i("重点知识")])),_:1}),O("ul",{class:"key-points-list"},[(c(!0),v(f,null,L(n.lesson.keyPoints,((e,s)=>(c(),v("li",{key:s,class:"key-point"},d(e),1)))),128))])])),_:1})])),_:1})}],["__scopeId","data-v-fb5d6212"]]),QuizMode:M({props:["lesson"],setup(e){const s=n(0),o=n(""),t=n(!1),a=l((()=>e.lesson.quiz[s.value])),u=l((()=>e.lesson.quiz.length)),r=l((()=>(s.value+1)/u.value*100));return{currentQuestion:a,currentQuestionIndex:s,totalQuestions:u,selectedAnswer:o,showResult:t,selectAnswer:e=>{t.value||(o.value=e,t.value=!0,e===a.value.correctAnswer?setTimeout((()=>{s.value<u.value-1?(s.value++,o.value="",t.value=!1):console.log("Quiz completed!")}),1e3):setTimeout((()=>{t.value=!1,o.value=""}),1e3))},progress:r}}},[["render",function(e,s,n,o,l,t){const _=r,g=k,m=w;return c(),a(_,{class:"quiz-mode"},{default:u((()=>[p(_,{class:"progress-container"},{default:u((()=>[p(_,{class:"progress-bar"},{default:u((()=>[p(_,{class:"progress",style:h({width:`${o.progress}%`})},null,8,["style"])])),_:1}),p(_,{class:"progress-text"},{default:u((()=>[i(d(o.currentQuestionIndex+1)+" / "+d(o.totalQuestions),1)])),_:1})])),_:1}),p(_,{class:"question-container"},{default:u((()=>[p(g,{class:"question"},{default:u((()=>[i(d(o.currentQuestion.question),1)])),_:1})])),_:1}),p(_,{class:"options-container"},{default:u((()=>[(c(!0),v(f,null,L(o.currentQuestion.options,((e,s)=>(c(),a(m,{key:s,onClick:s=>o.selectAnswer(e),class:C(["option-button",{selected:o.selectedAnswer===e},{correct:o.showResult&&e===o.currentQuestion.correctAnswer},{incorrect:o.showResult&&o.selectedAnswer===e&&e!==o.currentQuestion.correctAnswer}]),disabled:o.showResult},{default:u((()=>[i(d(e),1)])),_:2},1032,["onClick","class","disabled"])))),128))])),_:1})])),_:1})}],["__scopeId","data-v-92b0311d"]]),FullLessonDictation:M(g({props:{lesson:{type:Object,required:!0}},emits:["correct"],setup(e,{emit:s}){const o=n(""),t=n(!1),a=n(!1),u=l((()=>e.lesson.content.map((e=>e.english.trim())).join(" ").toLowerCase())),r=l((()=>a.value?"正确!":"不正确,请重试"));return{fullLessonInput:o,checkFullLesson:()=>{const e=o.value.trim().toLowerCase();a.value=e===u.value,t.value=!0,a.value&&(s("correct"),o.value="")},showResult:t,isCorrect:a,resultMessage:r}}}),[["render",function(e,s,n,o,l,t){const v=T,f=w,_=r;return c(),a(_,{class:"full-lesson-dictation"},{default:u((()=>[p(v,{modelValue:e.fullLessonInput,"onUpdate:modelValue":s[0]||(s[0]=s=>e.fullLessonInput=s),class:"full-lesson-input",placeholder:"请输入完整的英文课文",onKeyup:I(e.checkFullLesson,["enter"])},null,8,["modelValue","onKeyup"]),p(f,{onClick:e.checkFullLesson,class:"check-button"},{default:u((()=>[i("检查")])),_:1},8,["onClick"]),e.showResult?(c(),a(_,{key:0,class:C(["result",{correct:e.isCorrect}])},{default:u((()=>[i(d(e.resultMessage),1)])),_:1},8,["class"])):b("",!0)])),_:1})}],["__scopeId","data-v-6efd2eb6"]])},setup(){const e=n("dictation"),s=n({}),o=n(!0),l=n("");return t((async()=>{try{await A.loadLessons(2),s.value=A.getLessons().value[0],o.value=!1}catch(e){l.value="加载课程失败，请重试",o.value=!1}})),{currentMode:e,currentLesson:s,isLoading:o,error:l,modes:[{label:"默写",value:"dictation"},{label:"阅读",value:"reading"},{label:"答题",value:"quiz"},{label:"全文默写",value:"fullLessonDictation"}],selectMode:s=>{e.value=s},onLessonChanged:e=>{s.value=e},onFullLessonCorrect:()=>{console.log("全文默写正确!")}}}},[["render",function(e,s,n,o,l,t){const _=y("lesson-selector"),g=r,h=w,k=y("dictation-mode"),m=y("reading-mode"),I=y("quiz-mode"),x=y("full-lesson-dictation");return c(),a(g,{class:"container"},{default:u((()=>[p(g,{class:"header"},{default:u((()=>[p(g,{class:"lesson-selector-row"},{default:u((()=>[p(_,{onLessonChanged:o.onLessonChanged},null,8,["onLessonChanged"])])),_:1}),p(g,{class:"mode-selector-row"},{default:u((()=>[(c(!0),v(f,null,L(o.modes,(e=>(c(),a(h,{key:e.value,onClick:s=>o.selectMode(e.value),class:C(["mode-button",{active:o.currentMode===e.value}])},{default:u((()=>[i(d(e.label),1)])),_:2},1032,["onClick","class"])))),128))])),_:1})])),_:1}),o.isLoading?(c(),a(g,{key:0,class:"loading"},{default:u((()=>[i("加载中...")])),_:1})):o.error?(c(),a(g,{key:1,class:"error"},{default:u((()=>[i(d(o.error),1)])),_:1})):(c(),a(g,{key:2,class:"content"},{default:u((()=>["dictation"===o.currentMode?(c(),a(k,{key:0,lesson:o.currentLesson},null,8,["lesson"])):"reading"===o.currentMode?(c(),a(m,{key:1,lesson:o.currentLesson},null,8,["lesson"])):"quiz"===o.currentMode?(c(),a(I,{key:2,lesson:o.currentLesson},null,8,["lesson"])):"fullLessonDictation"===o.currentMode?(c(),a(x,{key:3,lesson:o.currentLesson,onCorrect:o.onFullLessonCorrect},null,8,["lesson","onCorrect"])):b("",!0)])),_:1}))])),_:1})}],["__scopeId","data-v-dd7f3fb3"]]);export{P as default};
